# 软件需求规格说明书

一、引言

1.1 编写目的

​	软件戏曲规格说明描述了“Bayan/Piano”1.0版本的软件功能性需求和非功能性需求。这一文档供参与开发程序以及验证程序功能性的项目团队成员使用。除非在其他地方另有说明，这里指定的所有需求都具有高优先级，并且都要在1.0版本中得以实现。

1.2 文档约定

​	编写文档时，所有项目团队成员应该使用Typora软件进行编写，以保持排版和字体等方面的一致性。

1.3 读者对象和阅读建议

​	该软件需求规格说明针对开发人员、项目经理、用户及测试人员。本文分别介绍了产品的愿景规划、用户功能、运行环境以及系统的功能点具体描述。

1.4 项目范围

​	“Bayan/Piano”允许人们在网页上用键盘演奏Bayan和Piano等乐器，并且还可以在线选定指定的歌曲来让这款在线乐器进行自动弹奏，当然也支持让用户在本地拖拉想挺的歌曲（.mid格式）到网页中，让网页自动弹奏这首歌。该在线乐器程序支持两种弹奏方式（Bayan布局和Piano布局），还支持多种乐器音以及播放歌曲，在今后的拓展中还可加上节奏游戏等玩法，让这个程序的功能变得更加丰富。

二、总体描述

2.1 产品前景

Color-Bayan是一个简单的在线乐器系统，它逼真地模拟了各种乐器的体验过程。系统使用标准的音色谱，通过电脑键盘的敲击，发出与选中的模拟乐器完全一样的音乐，与实体乐器的体验可以说的完全一致的。并且，在Color-Bayan中，用户可以选择不同的弹奏键盘，选中不同的乐曲，不同的乐器，也就是说，Color-Bayan集多种乐器于一身，功能强大。这种体验对于那些经济实力比较差的音乐爱好者来说，无疑是一种福利。可见，Color-Bayan系统的应用前景还是相当广的。

2.2 产品的功能

Color-Bayan系统集多种乐器于一身，具备以下标准功能：

1. 切换乐器键盘。用户可以切换常用的bayan键盘和piano键盘，这两个键盘与实物键盘完全一致，并且鼠标点击或者键盘敲击时，不同按钮会发出相应的声音。
2. 切换弹奏键盘。系统默认是KeyboardMap3键盘，用户通过点击切换按钮，可以切换为KeyboardMap4键盘，这个完全由个人弹奏习惯决定。
3. 选择歌曲。用户通过点击选择按钮，可以向服务器发起音乐库查询，点击查询结果的某一首歌曲，系统自动弹唱该歌曲。
4. 选择乐器。用户通过点击按钮，可以选择的乐器有三种：accordion、music_box和piano。选择不同的乐器弹奏同一首歌曲也是一种特殊的体验。


2.3 用户类及其特征

Color-Bayan系统的主要用户群体为：bayan音乐爱好者、piano音乐爱好者以及music_box音乐爱好者。在这些音乐爱好者中，主要为经济实力一般的群体，当然也包括经济实力比较好但喜欢尝试新事物的群体。

另外，次要的用户主要就是对新事物感兴趣的年轻人。他们对各种互联网新产品感兴趣，喜欢尝试，有时间有精力。

2.4 运行环境

Color-Bayan系统是托管在个人服务器上的在线网页系统，用户可以通过在浏览器输入[http://123.207.110.18:8081/](http://123.207.110.18:8081/)进行体验。当然，若用户对于我们的源码感兴趣或者想尝试一下在本地的运行情况，可以到我们的[github](https://github.com/8MarkOut/Color-Bayan)上将项目clone下来，根据markdown文件的提示进行安装和运行即可。Color-Bayan系统无关乎平台，Windows或者Linux或者Mac都行，运行后只需要打开[http://localhost:8081/Color-Bayan](http://localhost:8081/Color-Bayan)即可。

2.5 假设和依赖

- AS-1：只要服务端打开8081端口并处于运行状态中，Color-Bayan系统均能正常运行，用户可以正常体验。

- DE-1：Color-Bayan系统的查询乐曲依赖于服务端的音乐库，若服务端音乐库变更或者移除，Color-Bayan系统无法弹奏音乐。


三、系统功能

3.1 描述和优先级

​	当用户打开网页时，网页会自动向服务器发送请求乐器列表和歌曲列表的请求，当接收到回应后便会动态创建这些乐器名和歌曲名所对应的按钮。用户首先看到的是Bayan布局的键盘，他们可以通过点击Piano按钮来切换到Piano布局的键盘。当用户点击切换乐器后，网页便会向服务器请求该乐器的音源文件，接收音乐文件后本地会更改至使用音色文件，随后键盘发出的音色便会切换至该种乐器。当用户点击某一个歌曲按钮时，网页会向服务器请求该歌曲的mid文件，在接收完毕后，用户按下空格键，键盘便会自动弹奏该歌曲，当用户再次按下空格键时便会暂停弹奏。

3.2 请求/相应序列

用户：打开网页，请求乐器列表和歌曲列表。

响应：服务器向用户返回乐器列表和歌曲列表。

用户：动态创建乐器按钮和歌曲按钮。

用户：点击切换乐器按钮，向服务器请求该乐器音源文件。

响应：返回该乐器音源文件。

用户：使用音源文件。

用户：点击歌曲文件，向服务器请求该歌曲文件。

响应：返回该歌曲文件。

用户：按下空格键后自动弹奏该歌曲。

3.3 功能性需求

| 功能   | 描述                                       |
| ---- | ---------------------------------------- |
| 用户弹奏 | 用户在打开网页后，便能通过按下键盘对应的按钮，来进行弹奏。            |
| 切换乐器 | 用户点击切换乐器按钮后，再选择想切换至的乐器，便会向服务器发送该乐器音源文件的请求，在接收音源文件后便会使用该文件。 |
| 播放歌曲 | 用户点击播放歌曲后，再选择想播放的歌曲，便会向服务器发送该歌曲mid文件的请求，在接收mid文件后，按下空格键便会自动演奏该歌曲。 |
| 切换键盘 | 用户可以点击Bayan或Piano来更改弹奏键盘的布局。             |

四、外部接口需求

4.1 用户界面

- UI-1：Color-Bayan系统主界面，界面主要部分为弹奏键盘，另外还包括切换弹奏键盘的点击按钮、选择音乐按钮、选择乐器按钮等等。Color-Bayan系统只有这一个用户界面，但“短小精悍”。

4.2 硬件接口

若用户在本地运行Color-Bayan系统，则需要本地系统允许使用8081端口并且打开8081端口；例如在Windows操作系统上本地运行时，需要Windows防火墙允许打开8081端口。若用户通过URL访问Color-Bayan系统，则需要在服务器正常运行的前提下才能访问，而且服务器的Linux系统需要打开8081端口。

4.3 软件接口

- SI-1：Color-Bayan前端系统
  - SI-1.1：Color-Bayan前端系统向服务器的/musicList路由路径发起网络请求，以此查询服务器的乐库列表
  - SI-1.2：Color-Bayan前端系统向服务器的/music路由路径发起网络请求，以此向服务器获取某个音乐文件
  - SI-1.3：Color-Bayan前端系统向服务器的/instrument路由路径发起网络请求，以此向服务器查询系统所支持的乐器列表
  - SI-1.4：Color-Bayan前端系统向服务器的/getInstrument路由路径发起网络请求，以此向服务器查询并获取某个乐器的乐谱

五、其他非功能性需求

5.1 性能需求

PE-1：由于使用的服务器上传速率有限，因此接收一个乐器的音源文件大概需要5秒，接收一首歌的mid文件大概需要10秒。

PE-2：当用户短时间内点击多首歌曲的按钮时，应该以最后一首歌曲为准，不能让用户同时下载多首歌曲，否则会造成长时间的下载时间。

PE-3：当用户点击已切换过的乐器或者已播放过的歌曲时，应先在缓存中查找是否下载过该文件，否则会对服务器造成负担。

5.2 软件质量属性

​	Availability(可用性)：“Bayan/Piano”将对所有联网的用户可用，服务器24小时不关机，因此用户可随时通过访问对应ip地址的端口来使用该程序。

5.4 其他需求

​	国际化需求：由于本程序中出现较少的文字，乐器名为大众所认识的英语，而歌曲名则是歌曲原名，并且程序使用简单，因此在国外和国内都能被很容易的使用。

​	配置需求：该程序的本地部署参考安装说明，由于该程序在本地部署会比较麻烦，因此强烈建议用户使用访问ip地址的方式来使用我们的程序。
